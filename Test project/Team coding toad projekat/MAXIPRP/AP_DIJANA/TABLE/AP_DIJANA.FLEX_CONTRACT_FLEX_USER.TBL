CREATE TABLE AP_DIJANA.FLEX_CONTRACT_FLEX_USER
(
  SF_CONTRACT         VARCHAR2(3 BYTE),
  VALID_FROM          DATE,
  VALID_TO            DATE,
  USER_ID             NUMBER,
  USER_CMS_ID         NUMBER,
  DATE_OF_SIGNING     DATE,
  WHO_CHANGED         NVARCHAR2(50),
  WHEN_CHANGED        DATE,
  SF_CONTRACT_PARENT  VARCHAR2(3 BYTE)
)
TABLESPACE USERS
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE;


CREATE UNIQUE INDEX AP_DIJANA.PK_USER_CONTRACT ON AP_DIJANA.FLEX_CONTRACT_FLEX_USER
(SF_CONTRACT, USER_ID, USER_CMS_ID)
LOGGING
TABLESPACE USERS
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           );

ALTER TABLE AP_DIJANA.FLEX_CONTRACT_FLEX_USER ADD (
  CONSTRAINT PK_USER_CONTRACT
  PRIMARY KEY
  (SF_CONTRACT, USER_ID, USER_CMS_ID)
  USING INDEX AP_DIJANA.PK_USER_CONTRACT
  ENABLE VALIDATE);


ALTER TABLE AP_DIJANA.FLEX_CONTRACT_FLEX_USER ADD (
  CONSTRAINT FK_CMS_CONTRACT 
  FOREIGN KEY (USER_CMS_ID) 
  REFERENCES AP_DIJANA.FLEX_USER_CMS (USER_CMS_ID)
  ENABLE VALIDATE
,  CONSTRAINT FK_CONTRACT_TYPE 
  FOREIGN KEY (SF_CONTRACT, SF_CONTRACT_PARENT) 
  REFERENCES AP_DIJANA.FLEX_CONTRACT_TYPE (SF_CONTRACT, SF_CONTRACT_PARENT)
  ENABLE VALIDATE
,  CONSTRAINT FK_USER_CONTRACT 
  FOREIGN KEY (USER_ID) 
  REFERENCES AP_DIJANA.FLEX_USER (USER_ID)
  ENABLE VALIDATE);
